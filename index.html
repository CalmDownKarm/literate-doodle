<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>AAP Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  {% set base = '.' %}
  {% include template-navbar.html %}
  <!-- TODO: Filter bars -->
  <div class="container-fluid">
    {%include banner.html %}
    <div class="nav nav-row pt-2 pb-1 mb-0 nav_buttons">
      <div class="col-md-4 text-center mx-auto" id="outcomeTab"> <a
          class="btn btn-primary btn-block h1 text-white">Explore by Outcome</a> </div>
      <div class="col-md-4 text-center mx-auto" id="departmentTab"><a
          class="btn btn-primary btn-block h1 text-white">Explore by Department</a></div>
    </div>

    <div class="d-flex flex-wrap justify-content-center">
      <template>
        <% outcomes.forEach(function(outcome){ %>
        <div class="card col-md-3 px-0">
          <img class="card-img-top img-fluid image-ka-size-hai-ye" src="<%= outcome.img %>">
          <div class="card-body">
            <h5 class="card-title"><%= outcome.Outcome? outcome.Outcome : outcome.Department %></h5>
            <a href="promises?Outcome=<%= outcome.Outcome %>">
              <p class="card-text">
                <%= outcome['Outcome|count']? outcome['Outcome|count'] : outcome['Department|count'] %> Promises</p>
            </a>
            <a href="updates?Outcome=<%= outcome.Outcome %>">
              <p class="card-text">
                <%= outcome['Outcome|count']? outcome['Outcome|count'] : outcome['Department|count'] %> Updates</p>
            </a>
          </div>
        </div>
        <% }) %>
      </template>
    </div>
  </div> <!-- .container-fluid -->

  <script src="ui/jquery/dist/jquery.min.js"></script>
  <script src="ui/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
  <script src="ui/lodash/lodash.min.js"></script><Fieldset></Fieldset>
  <script src="ui/g1/dist/g1.min.js"></script>
  <script>
    function draw_cards(groupField) {
      // Look up the appropriate set of urls and render the template
      let urls = {
        'outcomes': [
          'data/outcomes?_sort=Outcome',
          'data/promises?_by=Outcome&_c=Outcome|count',
          'data/updates?_by=Outcome&_c=OUtcome|count'
        ],
        'departments': [
          'data/department?_sort=Department',
          'data/promises?_by=Department&_c=Department|count',
          'data/updates?_by=Department&_c=Department|count'
        ]
      }
      url = urls[groupField]
      $.when(
        $.getJSON([0]),
        $.getJSON([1]),
        $.getJSON([2])
      ).done(function(field, promises, updates){
        outputs = _.merge(field, promises, updates)
        console.log(outputs)
        $('body').template({ outcomes: output[0] })
      })
    }
      
      
      
      $(function () {
        $('.nav_buttons').on('click', function () {
          $(this).get('')
        })
        $.when(
          $.get('data/outcomes?_sort=Outcome'),
          $.get('data/promises?_by=Outcome&_c=Outcome|count')
          // $.get('data/updates')
        ).done(function (outcomes, promises) {
          output = _.merge(outcomes, promises)
          console.log(output)
          $('body').template({ outcomes: output[0] })
        })

      })

      $('#outcomeTab').click(function () {
        $.when(
          $.get('data/outcomes?_sort=Outcome'),
          $.get('data/promises?_by=Outcome&_c=Outcome|count')
          // $.get('data/updates')
        ).done(function (outcomes, promises) {
          output = _.merge(outcomes, promises)
          console.log(output)
          $('body').template({ outcomes: output[0] })
        })
      });

      $('#departmentTab').click(function () {
        $.when(
          $.get('data/department?_sort=Department'),
          $.get('data/promises?_by=Department&_c=Department|count'),
          $.get('data/updates?_by=Department&_c=Department|count')
        ).done(function (outcomes, promises, updates) {
          output = _.merge(outcomes, promises, updates)
          console.log(output)
          $('body').template({ outcomes: output[0] })
        })
      });

  </script>
  <!-- Commonly used libraries:
  <script src="ui/d3v5/dist/d3.min.js"></script>
  <script src="ui/morphdom/dist/morphdom-umd.min.js"></script>
  <script src="ui/moment/min/moment-with-locales.min.js"></script>
  <script src="ui/daterangepicker/daterangepicker.js"></script>
  <script src="ui/leaflet/dist/leaflet.js"></script>
  <script src="ui/topojson/dist/topojson.min.js"></script>
  -->
</body>

</html>